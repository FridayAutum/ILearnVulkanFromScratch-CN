# 流水线复用

> 在一个三维场景中，可能有很多使用不同混合方式、视口大小等等参数的物体，这些物体很有可能导致事先需要创建出很多图形流水线出来，但这些流水线除了那些改动的部分，在其它方面可能高度类似。Vulkan 提供了很多种方法来简化这样类似流水线的创建和生成效率：
>
> * Dynamic State：将某些流水线阶段设置为可变的，并且在录制 Command  Buffer 时使用 `vkCmdSet` 系列指令动态修改流水线，实现流水线复用。
> * 流水线缓存：允许将之前生成好的流水线缓存起来。该缓存可以在创建新流水线的时候传入创建方法 `vkCreateGraphicsPipelines` 中，Vulkan 实现会尽其所能找到能够重用的部分。该缓存甚至可以被存储到硬盘上，下次运行程序时直接读取该缓存，节省创建时间。
> * 派生流水线：将之前的一个配置好的流水线里面的配置作为参考来配置一个新的流水线。注意，真正驱动端还是需要针对整个流水线重新编译 Shader，**并不会节省时间**（所以其实并不太推荐，并且很多厂商出的 Vulkan Tips 也不推荐使用派生流水线）。
>
> （摘自 Vulkan 基础/准备流程/图形流水线）

这一章就来具体实现一下这三种流水线复用的步骤，并且衡量它们的利弊。